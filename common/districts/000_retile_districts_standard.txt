district_clerks = {
	base_buildtime = @retile_city_build_time
	icon = district_arcology_housing
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build clerk jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					OR = {
						has_planet_flag = ai_urban
						has_planet_flag = ai_clerks
						retile_basic_economy = no
					}
					free_jobs < 1
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		job_clerk_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
		}
		modifier = {
			job_clerk_add = 1
		}
	}
	
	ai_weight = {
		weight = 10
		modifier = {
			factor = 11
			owner = { has_authority = auth_corporate }
		}
	}
}

district_engineers = {
	base_buildtime = @retile_city_build_time
	icon = district_engineering_arcology
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build engineer jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					OR = {
						has_planet_flag = ai_urban
						has_planet_flag = ai_engineers
					}
					retile_basic_economy = yes
					free_jobs < 1
				}
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		job_foundry_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
		}
		modifier = {
			job_foundry_add = 1
		}
	}
	
	ai_weight = {
		weight = 100
		modifier = {
			factor = 2
			owner = { has_monthly_income = { resource = alloys value < 25 } }
		}
		modifier = {
			factor = 0.25
			owner = { has_monthly_income = { resource = alloys value > 100 } }
		}
	}
}

district_scholars = {
	base_buildtime = @retile_city_build_time
	icon = district_research_arcology
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build scholar jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					OR = {
						has_planet_flag = ai_urban
						has_planet_flag = ai_scholars
					}
					retile_advanced_economy = yes
					free_jobs < 1
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		job_researcher_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
		}
		modifier = {
			job_researcher_add = 1
		}
	}
	
	ai_weight = {
		weight = 100

		modifier = {
			factor = 2
			retile_tech_weak = yes
		}
		modifier = {	# TODO: replace with general trigger for tech advancement
			factor = 2
			owner = {
				has_monthly_income = { resource = energy value > 75 }
				has_monthly_income = { resource = minerals value > 75 }
				has_monthly_income = { resource = food value > 25 }
				has_monthly_income = { resource = alloys value > 25 }
				has_monthly_income = { resource = consumer_goods value > 25 }
			}
		}
	}
}

district_diplomats = {
	base_buildtime = @retile_city_build_time
	icon = district_embassy_arcology
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		owner = { has_technology = tech_xenodiplomacy }
		hidden_trigger = { # Should AI build diplomat jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					OR = {
						has_planet_flag = ai_urban
						has_planet_flag = ai_diplomats
					}
					retile_basic_economy = yes
					free_jobs < 1
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {			### Diplomat Jobs
		job_diplomat_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { NOR = {
				has_policy_flag = xenodiplomacy_assembly
				has_policy_flag = xenodiplomacy_magistrate
				has_policy_flag = xenodiplomacy_lr
				has_policy_flag = xenodiplomacy_pr
				has_policy_flag = xenodiplomacy_isolation
				has_policy_flag = xenodiplomacy_gunboat
			} }
		}
		modifier = {
			job_diplomat_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = xenodiplomacy_assembly }
		}
		job_diplomat_add = -2
		job_representative_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = xenodiplomacy_assembly }
		}
		modifier = {
			job_representative_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = xenodiplomacy_magistrate }
		}
		job_diplomat_add = -2
		job_magistrate_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = xenodiplomacy_magistrate }
		}
		modifier = {
			job_magistrate_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = xenodiplomacy_lr }
		}
		job_diplomat_add = -2
		job_lr_manager_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = xenodiplomacy_lr }
		}
		modifier = {
			job_lr_manager_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = xenodiplomacy_pr }
		}
		job_diplomat_add = -2
		job_pr_manager_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = xenodiplomacy_pr }
		}
		modifier = {
			job_pr_manager_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = xenodiplomacy_isolation }
		}
		job_diplomat_add = -2
		job_bureaucrat_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = xenodiplomacy_isolation }
		}
		modifier = {
			job_bureaucrat_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = xenodiplomacy_gunboat }
		}
		job_diplomat_add = -2
		job_strategos_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = xenodiplomacy_gunboat }
		}
		modifier = {
			job_strategos_add = 1
		}
	}
	
	ai_weight = {
		weight = 10

		# TODO: modifiers???
	}
}

district_soldiers = {
	base_buildtime = @retile_city_build_time
	icon = district_prison
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build soldier jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					free_jobs < 1
					num_pops > 10
					AND = { owner = {
						has_monthly_income = { resource = alloys value > 25 }
						OR = {
							country_uses_goods = no
							has_monthly_income = { resource = consumer_goods value > 10 }
						}
						OR = {
							country_uses_food = no
							has_monthly_income = { resource = food value > 10 }
						}
						has_monthly_income = { resource = minerals value > 50 }
						has_monthly_income = { resource = energy value > 50 }
						OR = {
							is_plantoid_empire = no
							prev = { habitability = { who = owner.owner_species value > 0.7 } }
						}
					} }
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		job_soldier_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
		}
		modifier = {
			job_soldier_add = 1
		}
	}
	
	ai_weight = {
		weight = 10

		modifier = {
			factor = 11
			OR = {
				has_planet_flag = ai_soldiers
				num_districts = { type = district_soldiers value < 1 }
			}
		}
		modifier = {
			factor = 0
			NOT = { has_planet_flag = ai_soldiers }
			num_districts = { type = district_soldiers value > 1 }
		}
	}
}

district_enforcers = {
	base_buildtime = @retile_city_build_time
	icon = district_rw_nexus
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build enforcer jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					free_jobs < 1
					planet_crime > 33
					retile_basic_economy = yes
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		job_enforcer_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			NOT = { owner = { has_policy_flag = criminal_military_police } }
		}
		modifier = {
			job_enforcer_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_policy_flag = criminal_military_police }
		}
		job_enforcer_add = -2
		job_soldier_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
			owner = { has_policy_flag = criminal_military_police }
		}
		modifier = {
			job_soldier_add = 1
		}
	}	
	
	ai_weight = {
		weight = 100

		modifier = {
			factor = 2
			num_districts = { type = district_enforcers value < 1 }
		}
		modifier = {
			factor = 0.1
			num_districts = { type = district_enforcers value > 1 }
		}
	}
}

district_custodians = {
	base_buildtime = @retile_city_build_time
	icon = default
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build custodian jobs?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					free_jobs < 1
					OR = {
						AND = {
							free_amenities > 300
							retile_basic_economy = yes
						}
						OR = {
							retile_basic_economy = no
							has_planet_flag = ai_custodians
						}
					}
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		job_custodian_add = 2
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
		}
		modifier = {
			job_custodian_add = 1
		}
	}
	
	ai_weight = {
		weight = 100

		#modifier = {
		#	weight = 1000
		#	free_district_slots < 1
		#}
	}
}

district_housing = {
	base_buildtime = @retile_city_build_time
	icon = district_rw_city
	is_capped_by_modifier = no
	
	show_on_uncolonized = {
		exists = from
		from = { is_gestalt = no }
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOR = {
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
		}
	}
	
	allow = {
		hidden_trigger = { # Should AI build housing?
			OR = {
				NOT = { exists = owner }
				owner = { is_ai = no }
				AND = {
					free_jobs > 0
					free_housing < 1
				}				
			}
		}
	}

	resources = {
		category = planet_districts_cities
		cost = {
			minerals = @retile_city_cost
		}
		upkeep = {
			energy = @retile_city_upkeep
			consumer_goods = @retile_city_upkeep_supplies
		}
	}
	
	planet_modifier = {
		planet_housing_add = 5
	}
	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_city
			exists = owner
			owner = { has_ascension_perk = ap_arcology_project }
		}
		modifier = {
			planet_housing_add = 2
		}
	}
	
	ai_weight = {
		weight = 100

		#modifier = {
		#	weight = 1000
		#	free_district_slots < 1
		#}
	}
}
